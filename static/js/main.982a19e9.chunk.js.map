{"version":3,"sources":["logic/board.ts","logic/index.ts","logic/history.ts","fe/ViewCard.tsx","fe/ViewColumn.tsx","fe/ViewBoard.tsx","fe/App.tsx","reportWebVitals.ts","index.tsx","logic/util.ts","logic/column.ts","logic/card.ts"],"names":["Board","args","originalDeck","remainingDeck","columns","this","length","remainingDeals","Error","forEach","c","deal","pop","revealBottom","pointers","column","filter","index","columnIndex","card","cards","state","id","cardId","range","map","i","colId","col","canMoveBelowColumn","resolvePointers","possibleMovesFromObj","canMove","dest","popped","push","serialize","Column","deserialize","concat","History","deck","history","board","createNew","bs","current","peek","deepEqual","deepCopy","CompCard","styled","div","props","color","background","suitToSymbol","suitToColor","valueToString","ViewCard","canReceiveHover","onHover","trigger","emptyBg","faceUp","pointer","faceUpBg","suit","onClick","b","performMoveToPile","onContextMenu","performMoveToEmpty","onMouseEnter","onMouseLeave","undefined","value","CompColumn","ViewColumn","ci","arr","CompBoard","CompHeader","CompColumnContainer","ViewBoard","possibleMoves","undo","reset","possibleMoveIds","GenerateDeck","includes","App","useState","boardState","setBoardState","hover","setHover","triggerBoard","useCallback","cb","e","preventDefault","newBoard","useEffect","window","addEventListener","evt","code","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById","out","a","replacer","key1","Object","Array","keys","sort","reduce","sorted","key2","toJson","obj","JSON","stringify","parse","numSuits","subArr","flatten","v","GenerateCard","array","currentIndex","randomIndex","Math","floor","random","shuffle","Card","checkForRun","reveal","findIndex","relIndexOf","head","getHead","headIndex","topCard","reverse","newCards","leaf","getLeaf","relIndex","parent","canMoveTogether","canMoveBelowCard"],"mappings":"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","file":"static/js/main.982a19e9.chunk.js","sourcesContent":["import { Card } from \"./card\";\nimport { Column } from \"./column\";\nimport { BoardState, DeckState, Pointers } from \"./types\";\nimport { range } from \"./util\";\n\nexport class Board {\n  readonly originalDeck: DeckState;\n  readonly remainingDeck: DeckState;\n  readonly columns: Column[];\n  constructor(args: {\n    originalDeck: DeckState;\n    remainingDeck: DeckState;\n    columns: Column[];\n  }) {\n    this.originalDeck = args.originalDeck;\n    this.remainingDeck = args.remainingDeck;\n    this.columns = args.columns;\n  }\n\n  remainingDeals() {\n    return this.remainingDeck.length / this.columns.length;\n  }\n  deal() {\n    if (this.remainingDeals() < 1) {\n      throw new Error(\"deal is impossible\");\n    }\n    this.columns.forEach((c) => {\n      c.deal(this.remainingDeck.pop()!);\n      c.revealBottom();\n    });\n  }\n  private resolvePointers(pointers: Pointers): {\n    column: Column;\n    card: Card | undefined;\n  } {\n    const column = this.columns.filter(\n      (c) => c.index === pointers.columnIndex\n    )[0];\n    const card = column.cards.filter((c) => c.state.id === pointers.cardId)[0];\n    return { column, card };\n  }\n  private possibleMovesFromObj(column: Column, card?: Card): Column[] {\n    if (!card) {\n      return [];\n    }\n    const otherCols = range(this.columns.length - 1).map((i) => {\n      const colId = (column.index + i + 1) % this.columns.length;\n      return this.columns[colId];\n    });\n    const valid = otherCols.filter((col) => card.canMoveBelowColumn(col));\n    return valid;\n  }\n  possibleMoves(pointers: Pointers) {\n    const { column, card } = this.resolvePointers(pointers);\n    return this.possibleMovesFromObj(column, card);\n  }\n  performMoveToPile(pointers: Pointers) {\n    const { column, card } = this.resolvePointers(pointers);\n    if (!card) {\n      return;\n    }\n    const canMove = column.canMove(card);\n    if (!canMove) {\n      return;\n    }\n    const possibleMoves = this.possibleMovesFromObj(column, card);\n    const nonEmpty = possibleMoves.filter((col) => col.cards.length > 0);\n    const dest = nonEmpty[0];\n    if (dest) {\n      const popped = column.pop(card);\n      dest.push(popped);\n    }\n  }\n  performMoveToEmpty(pointers: Pointers) {\n    const { column, card } = this.resolvePointers(pointers);\n    if (!card) {\n      return;\n    }\n    const canMove = column.canMove(card);\n    if (!canMove) {\n      return;\n    }\n    const possibleMoves = this.possibleMovesFromObj(column, card);\n    const empty = possibleMoves.filter((col) => col.cards.length === 0);\n    const dest = empty[0];\n    if (dest) {\n      const popped = column.pop(card);\n      dest.push(popped);\n    }\n  }\n\n  serialize(): BoardState {\n    return {\n      originalDeck: this.originalDeck,\n      remainingDeck: this.remainingDeck,\n      columns: this.columns.map((c) => c.serialize()),\n    };\n  }\n  static deserialize(state: BoardState) {\n    const columns = state.columns.map((column) => Column.deserialize(column));\n    return new Board({\n      ...state,\n      columns,\n    });\n  }\n\n  static createNew(originalDeck: DeckState) {\n    const numColumns = 10;\n    const columns = range(numColumns).map((i) => new Column(i));\n    const remainingDeck = originalDeck.concat();\n\n    // deal all but 5 deals\n    for (let i = 0; remainingDeck.length > 5 * numColumns; i++) {\n      const column = columns[i % columns.length];\n      column.deal(remainingDeck.pop()!);\n    }\n\n    // reveal bottom\n    columns.forEach((c) => c.revealBottom());\n\n    return new Board({\n      originalDeck,\n      remainingDeck,\n      columns,\n    });\n  }\n}\n","export * from \"./board\";\nexport * from \"./card\";\nexport * from \"./column\";\nexport * from \"./history\";\nexport * from \"./types\";\nexport * from \"./util\";\n","import { Board } from \"./board\";\nimport { BoardState, DeckState } from \"./types\";\nimport { deepCopy, deepEqual } from \"./util\";\n\nexport class History {\n  private history: BoardState[];\n  constructor(deck: DeckState) {\n    const board = Board.createNew(deck);\n    this.history = [board.serialize()];\n  }\n  push(bs: BoardState) {\n    const current = this.peek();\n    if (!deepEqual(current, bs)) {\n      this.history.push(bs);\n    }\n  }\n  pop() {\n    if (this.history.length > 1) {\n      this.history.pop();\n    }\n  }\n  peek() {\n    return deepCopy(this.history[this.history.length - 1]);\n  }\n  reset(bs: BoardState) {\n    this.history = [bs];\n  }\n}\n","import React from 'react';\nimport { Board, Callback, Card, Column, Pointers, Trigger } from \"../logic\";\n\nimport styled from 'styled-components';\nconst CompCard = styled.div<{ color: string, background: string, canMove: boolean }>`\n  --suit: ${props => props.color};\n  padding: 0.5em;\n  width: 4em;\n  text-align: center;\n  color: var(--suit);\n  background: ${props => props.background};\n  border: 1px solid var(--suit);\n  border-radius: 0.5em;\n  cursor: ${props => props.canMove ? 'pointer' : 'not-allowed'};\n`;\n\nconst suitToSymbol = [\n  '♠️',\n  '♥️',\n  '♦️',\n  '♣️',\n];\nconst suitToColor = [\n  'black',\n  'red',\n  'darkviolet',\n  'green',\n];\nconst valueToString = [\n  'A',\n  '2',\n  '3',\n  '4',\n  '5',\n  '6',\n  '7',\n  '8',\n  '9',\n  '10',\n  'J',\n  'Q',\n  'K',\n];\n\nexport function ViewCard(props: {\n  column: Column,\n  card: Card | undefined,\n  canReceiveHover: boolean;\n  onHover: Callback<Pointers | undefined>,\n  trigger: Trigger<Board>,\n}) {\n  const {\n    column,\n    card,\n    canReceiveHover,\n    onHover,\n    trigger,\n  } = props;\n  if (!card) {\n    const emptyBg = canReceiveHover ? 'lightgreen' : 'white';\n    return (\n      <CompCard canMove={false} color='grey' background={emptyBg}>\n        (empty)\n      </CompCard>\n    );\n  }\n  if (card.state.faceUp) {\n    const pointer: Pointers = { columnIndex: column.index, cardId: card.state.id, };\n    const canMove = column.canMove(card);\n    const faceUpBg = (\n      (!canMove && 'lightgrey') ||\n      (canReceiveHover && 'lightgreen') ||\n      'white'\n    );\n    return (\n      <CompCard\n        canMove={canMove}\n        color={suitToColor[card.suit]}\n        background={faceUpBg}\n        onClick={trigger(b => b.performMoveToPile(pointer))}\n        onContextMenu={trigger(b => b.performMoveToEmpty(pointer))}\n        onMouseEnter={() => onHover(pointer)}\n        onMouseLeave={() => onHover(undefined)}\n      >\n        {valueToString[card.value]} {suitToSymbol[card.suit]}\n      </CompCard>\n    );\n  }\n  const hiddenBg = `repeating-linear-gradient(\n    45deg,\n    #606dbc,\n    #606dbc 10px,\n    #465298 10px,\n    #465298 20px\n  )`;\n  return (\n    <CompCard canMove={false} color='white' background={hiddenBg}>\n      ???\n    </CompCard>\n  );\n}\n","import React from 'react';\nimport { ViewCard } from './ViewCard';\nimport { Board, Callback, Column, Pointers, Trigger } from \"../logic\";\n\nimport styled from 'styled-components';\nconst CompColumn = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  align-items: flex-start;\n  flex-wrap: nowrap;\n\n  padding: 1em;\n`;\n\nexport function ViewColumn(props: {\n  column: Column;\n  canReceiveHover: boolean;\n  onHover: Callback<Pointers | undefined>;\n  trigger: Trigger<Board>;\n}) {\n  const {\n    column,\n    canReceiveHover,\n    onHover,\n    trigger,\n  } = props;\n  return (\n    <CompColumn>\n      {column.cards.length === 0 && (\n        <ViewCard\n          column={column}\n          card={undefined}\n          canReceiveHover={canReceiveHover}\n          onHover={() => undefined}\n          trigger={trigger}\n        />\n      )}\n      {column.cards.map((card, ci, arr) => (\n        <ViewCard\n          key={ci}\n          column={column}\n          card={card}\n          canReceiveHover={canReceiveHover && ci === arr.length - 1}\n          onHover={onHover}\n          trigger={trigger}\n        />\n      ))}\n    </CompColumn>\n  )\n}\n","import React from 'react';\nimport { Board, Callback, CardState, Column, EmptyCallback, GenerateDeck, Pointers, Trigger } from \"../logic\";\nimport { ViewColumn } from './ViewColumn';\n\nimport styled from 'styled-components';\nimport { toUnicode } from 'punycode';\nconst CompBoard = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  align-items: flex-start;\n  flex-wrap: nowrap;\n`;\nconst CompHeader = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: flex-start;\n  align-items: flex-start;\n  flex-wrap: nowrap;\n\n  padding: 1em;\n\n  & > * {\n    margin-right: 1em;\n  }\n`;\nconst CompColumnContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: flex-start;\n  align-items: flex-start;\n  flex-wrap: nowrap;\n`;\n\nexport function ViewBoard(props: {\n  board: Board;\n  possibleMoves: Column[];\n  onHover: Callback<Pointers | undefined>;\n  undo: EmptyCallback;\n  trigger: Trigger<Board>;\n  reset: Callback<Board>;\n}) {\n  const {\n    board,\n    possibleMoves,\n    onHover,\n    undo,\n    trigger,\n    reset,\n  } = props;\n  const remainingDeals = board.remainingDeals();\n  const possibleMoveIds = possibleMoves.map(col => col.index);\n  return (\n    <CompBoard>\n      <CompHeader>\n        <div>\n          Restart game:\n        </div>\n        <button onClick={() => reset(Board.createNew(GenerateDeck(1)))}>\n          1 suit\n        </button>\n        <button onClick={() => reset(Board.createNew(GenerateDeck(2)))}>\n          2 suit\n        </button>\n        <button onClick={() => reset(Board.createNew(GenerateDeck(3)))}>\n          3 suit\n        </button>\n        <button onClick={() => reset(Board.createNew(GenerateDeck(4)))}>\n          4 suit\n        </button>\n      </CompHeader>\n      <CompHeader>\n        <div>\n          <div>Left click to move to the next available pile</div>\n          <div>Right click to move to the next empty pile</div>\n        </div>\n        {remainingDeals ? (\n          <button onClick={trigger(b => b.deal())}>\n            Deal {remainingDeals}\n          </button>\n        ) : null}\n        <button onClick={undo}>\n          Undo (Z)\n        </button>\n      </CompHeader>\n      <CompColumnContainer>\n        {board.columns.map((column, ci) => (\n          <ViewColumn key={ci} column={column} canReceiveHover={possibleMoveIds.includes(ci)} onHover={onHover} trigger={trigger} />\n        ))}\n      </CompColumnContainer>\n    </CompBoard>\n  );\n}\n","import React, { useCallback, useEffect, useState } from 'react';\nimport { Board, Callback, GenerateDeck, History, Pointers } from '../logic';\nimport { ViewBoard } from './ViewBoard';\n\nconst history = new History(GenerateDeck(4));\n\nexport function App() {\n  const [boardState, setBoardState] = useState(history.peek());\n  const [hover, setHover] = useState(undefined as Pointers | undefined);\n\n  const triggerBoard = useCallback((cb: Callback<Board>) => {\n    const onTrigger = (e: any) => {\n      if (e && e.preventDefault) {\n        e.preventDefault();\n      }\n      const newBoard = Board.deserialize(boardState);\n      cb(newBoard);\n      history.push(newBoard.serialize());\n      setBoardState(history.peek());\n    };\n    return onTrigger;\n  }, [boardState, setBoardState]);\n\n  const undo = useCallback(() => {\n    history.pop();\n    setBoardState(history.peek());\n  }, [setBoardState]);\n\n  const reset = useCallback((newBoard: Board) => {\n    history.reset(newBoard.serialize());\n    setBoardState(history.peek());\n  }, [setBoardState]);\n\n  useEffect(() => {\n    window.addEventListener('keypress', evt => {\n      if (evt.code === 'KeyZ') {\n        undo();\n      };\n    });\n  }, [undo]);\n\n  const board = Board.deserialize(boardState);\n  const possibleMoves = hover ? board.possibleMoves(hover) : [];\n  return (\n    <ViewBoard\n      board={board}\n      possibleMoves={possibleMoves}\n      onHover={setHover}\n      undo={undo}\n      trigger={triggerBoard}\n      reset={reset} />\n  );\n}\n","import { ReportHandler } from \"web-vitals\";\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import(\"web-vitals\").then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport { App } from './fe/App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","import { CardState, DeckState } from \"./types\";\n\nexport function range(length: number): number[] {\n  const out = [] as number[];\n  for (let i = 0; i < length; i++) {\n    out.push(i);\n  }\n  return out;\n}\nexport function flatten<T>(arr: T[][]): T[] {\n  // dumb polyfill for jest\n  // https://github.com/kulshekhar/ts-jest/issues/828\n  const out = [] as T[];\n  arr.forEach((subArr) => out.push(...subArr));\n  return out;\n}\nexport function shuffle<T>(array: T[]) {\n  // https://stackoverflow.com/a/2450976\n  let currentIndex = array.length;\n  let randomIndex = 0;\n\n  // While there remain elements to shuffle...\n  while (0 !== currentIndex) {\n    // Pick a remaining element...\n    randomIndex = Math.floor(Math.random() * currentIndex);\n    currentIndex--;\n\n    // And swap it with the current element.\n    [array[currentIndex], array[randomIndex]] = [\n      array[randomIndex],\n      array[currentIndex],\n    ];\n  }\n  return array;\n}\nexport function deepEqual<T>(a: T, b: T): boolean {\n  if (!a === !!b) {\n    return false;\n  }\n  // https://gist.github.com/davidfurlong/463a83a33b70a3b6618e97ec9679e490\n  const replacer = (key1: string, value: any): any =>\n    value instanceof Object && !(value instanceof Array)\n      ? Object.keys(value)\n          .sort()\n          .reduce((sorted: any, key2) => {\n            sorted[key2] = value[key2];\n            return sorted;\n          }, {})\n      : value;\n  function toJson(obj: T) {\n    return JSON.stringify(obj, replacer);\n  }\n  return toJson(a) === toJson(b);\n}\nexport function deepCopy<T>(obj: T): T {\n  return JSON.parse(JSON.stringify(obj));\n}\n\nexport function GenerateCard(\n  index: number,\n  suit: number,\n  value: number\n): CardState {\n  return {\n    id: index,\n    code: suit * 100 + value,\n    faceUp: false,\n  };\n}\n\nexport function GenerateDeck(numSuits: number) {\n  const rows = range(8).map((i) => {\n    const suit = i % numSuits;\n    const cards = range(13).map((v) => GenerateCard(i * 13 + v, suit, v));\n    return cards;\n  });\n  const deck: DeckState = flatten(rows);\n  shuffle(deck);\n  return deck;\n}\n","import { Card } from \"./card\";\nimport { CardState, ColumnState } from \"./types\";\n\nexport class Column {\n  constructor(readonly index: number, readonly cards: Card[] = []) {}\n\n  deal(state: CardState) {\n    this.cards.push(new Card(state));\n    this.checkForRun();\n  }\n  revealBottom() {\n    this.cards[this.cards.length - 1]?.reveal();\n  }\n  private relIndexOf(card: Card): number {\n    return this.cards.findIndex((c) => c.state.id === card.state.id);\n  }\n  canMove(card: Card) {\n    if (!card.state.faceUp) {\n      return false;\n    }\n    const index = this.relIndexOf(card);\n    if (index < 0) {\n      return false;\n    }\n    if (index === this.cards.length - 1) {\n      return true;\n    }\n    const head = this.getHead();\n    if (head) {\n      const headIndex = this.relIndexOf(head);\n      if (headIndex >= 0 && headIndex <= index) {\n        return true;\n      }\n    }\n    return false;\n  }\n  pop(topCard: Card): Card[] {\n    const index = this.relIndexOf(topCard);\n    if (index < 0) {\n      throw new Error(\"illegal move\");\n    }\n    const popped: Card[] = [];\n    while (this.cards.length > index) {\n      popped.push(this.cards.pop()!);\n    }\n    this.revealBottom();\n    return popped.reverse();\n  }\n  push(newCards: Card[]): void {\n    this.cards.push(...newCards);\n    this.checkForRun();\n  }\n  checkForRun() {\n    const head = this.getHead();\n    if (head?.value !== 12) {\n      return;\n    }\n    const leaf = this.getLeaf();\n    if (leaf?.value !== 0) {\n      return;\n    }\n    this.pop(head);\n  }\n\n  getHead(): Card | undefined {\n    let relIndex = this.cards.length - 1;\n    let head = this.cards[relIndex];\n    let parent = this.cards[relIndex - 1];\n    while (parent && head && head.canMoveTogether(parent)) {\n      relIndex--;\n      head = this.cards[relIndex];\n      parent = this.cards[relIndex - 1];\n    }\n    return head;\n  }\n  getLeaf(): Card | undefined {\n    return this.cards[this.cards.length - 1];\n  }\n\n  serialize(): ColumnState {\n    return {\n      index: this.index,\n      cards: this.cards.map((c) => c.serialize()),\n    };\n  }\n  static deserialize(state: ColumnState) {\n    const cards = state.cards.map((card) => Card.deserialize(card));\n    return new Column(state.index, cards);\n  }\n}\n","import { Column } from \"./column\";\nimport { CardState } from \"./types\";\n\nexport class Card {\n  readonly suit: number;\n  readonly value: number;\n  constructor(readonly state: CardState) {\n    this.suit = Math.floor(state.code / 100);\n    this.value = state.code % 100;\n  }\n\n  reveal() {\n    this.state.faceUp = true;\n  }\n  private canMoveBelowCard(parent: Card) {\n    return this.value + 1 === parent.value;\n  }\n  canMoveTogether(parent: Card) {\n    return this.suit === parent.suit && this.canMoveBelowCard(parent);\n  }\n  canMoveBelowColumn(column: Column) {\n    const current = column.getLeaf();\n    return !current || this.canMoveBelowCard(current);\n  }\n\n  serialize(): CardState {\n    return this.state;\n  }\n  static deserialize(state: CardState) {\n    return new Card(state);\n  }\n}\n"],"sourceRoot":""}